{% extends "base.html" %}
{% block title %}{{ action }} IA{% endblock %}
{% block content %}
<h2 class="text-xl font-bold mb-4">{{ action }} IA</h2>
<form method="post" class="grid gap-4 md:grid-cols-2 bg-white p-6 rounded shadow">
    <div>
        <label class="block mb-1 font-medium" for="name">Nome</label>
        <input type="text" class="w-full border rounded px-3 py-2" id="name" name="name"
            value="{{ ia.name if ia else '' }}" required placeholder="Nome da IA">
    </div>
    <div>
        <label class="block mb-1 font-medium" for="phone_number">Telefone</label>
        <input type="text" class="w-full border rounded px-3 py-2" id="phone_number" name="phone_number"
            value="{{ ia.phone_number if ia else '' }}" required placeholder="Ex: 5511999999999">
    </div>
    <div>
        <label class="block mb-1 font-medium" for="channel">Canal</label>
        <input type="text" class="w-full border rounded px-3 py-2" id="channel" name="channel"
            value="{{ ia.ia_config.channel if ia and ia.ia_config else '' }}" required placeholder="Ex: whatsapp">
    </div>
    <div>
        <label class="block mb-1 font-medium" for="ia_used">Provedor IA</label>
        <select class="w-full border rounded px-3 py-2" id="ia_used" name="ia_used" required>
            <option value="">Selecione...</option>
            <option value="openai" {% if ia and ia.ia_config and ia.ia_config.ai_api=='openai' %}selected{% endif %}>
                OpenAI</option>
            <option value="anthropic" {% if ia and ia.ia_config and ia.ia_config.ai_api=='anthropic' %}selected{% endif
                %}>Anthropic</option>
            <option value="groq" {% if ia and ia.ia_config and ia.ia_config.ai_api=='groq' %}selected{% endif %}>Groq
            </option>
        </select>
    </div>
    <div>
        <label class="block mb-1 font-medium" for="apikey">API Key</label>
        <input type="password" class="w-full border rounded px-3 py-2" id="apikey" name="apikey" value=""
            placeholder="Sua chave de API">
        {% if ia and ia.ia_config %}
        <small class="text-gray-500">JÃ¡ cadastrada. Preencha para alterar.</small>
        {% endif %}
    </div>
    <div>
        <label class="block mb-1 font-medium" for="model">Modelo</label>
        <input type="text" class="w-full border rounded px-3 py-2" id="model" name="model"
            value="{{ ia.ia_config.credentials['ai_model'] if ia and ia.ia_config else '' }}" required
            placeholder="Ex: gpt-4o-mini">
    </div>
    <div>
        <label class="block mb-1 font-medium" for="status">Status</label>
        <select class="w-full border rounded px-3 py-2" id="status" name="status" required>
            <option value="True" {% if ia and ia.status %}selected{% endif %}>Ativo</option>
            <option value="False" {% if ia and not ia.status %}selected{% endif %}>Inativo</option>
        </select>
    </div>
    <div class="md:col-span-2 flex gap-2">
        <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">{{ action }}</button>
        <a href="{{ url_for('index') }}"
            class="bg-gray-200 text-gray-700 px-4 py-2 rounded hover:bg-gray-300">Cancelar</a>
    </div>
</form>
{% endblock %}