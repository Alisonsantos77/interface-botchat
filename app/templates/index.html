{% extends "base.html" %}
{% block title %}IAs Cadastradas{% endblock %}
{% block content %}
<div class="flex justify-between items-center mb-6">
  <h2 class="text-xl font-bold">IAs Cadastradas</h2>
  <a href="{{ url_for('create_ia') }}" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Nova IA</a>
</div>
<div class="overflow-x-auto bg-white rounded shadow">
  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-50">
      <tr>
        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Nome</th>
        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Telefone</th>
        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Status</th>
        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">API</th>
        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Prompt Ativo</th>
        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Ações</th>
      </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-200">
      {% for ia in ias %}
      <tr>
        <td class="px-4 py-2">{{ ia.name }}</td>
        <td class="px-4 py-2">{{ ia.phone_number }}</td>
        <td class="px-4 py-2">
          {% if ia.status %}
          <span class="px-2 py-1 rounded bg-green-100 text-green-700 text-xs">Ativo</span>
          {% else %}
          <span class="px-2 py-1 rounded bg-gray-200 text-gray-700 text-xs">Inativo</span>
          {% endif %}
        </td>
        <td class="px-4 py-2">{{ ia.configs[0].ai_api if ia.configs else '' }}</td>
        <td class="px-4 py-2">{{ ia.prompts[0].text[:40] ~ ('...' if ia.prompts[0].text|length > 40 else '') if
          ia.prompts else 'Nenhum' }}</td>
        <td class="px-4 py-2 flex gap-2">
          <a href="{{ url_for('edit_ia', id_ia=ia.id) }}" class="text-blue-600 hover:underline">Editar</a>
          <form action="{{ url_for('delete_ia', id_ia=ia.id) }}" method="post"
            onsubmit="return confirm('Excluir esta IA?');">
            <button type="submit" class="text-red-600 hover:underline">Excluir</button>
          </form>
          <a href="{{ url_for('get_leads_ia', ia_id=ia.id) }}" class="text-gray-600 hover:underline">Leads</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}